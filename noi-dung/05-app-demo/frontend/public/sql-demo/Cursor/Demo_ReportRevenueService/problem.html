<!DOCTYPE html>
<html lang="vi">

<head>
      <meta charset="UTF-8">
      <style>
            body {
                  font-family: 'Inter', -apple-system, sans-serif;
                  line-height: 1.7;
                  color: #1e293b;
                  background: #fff;
                  margin: 0;
                  padding: 0;
            }

            h1 {
                  font-size: 1.875rem;
                  font-weight: 700;
                  color: #7c3aed;
                  margin: 0 0 1.5rem 0;
                  padding-bottom: 0.75rem;
                  border-bottom: 2px solid #8b5cf6;
            }

            h2 {
                  font-size: 1.5rem;
                  font-weight: 600;
                  color: #0f172a;
                  margin: 2rem 0 1rem 0;
            }

            h3 {
                  font-size: 1.125rem;
                  font-weight: 600;
                  color: #334155;
                  margin: 1.5rem 0 0.75rem 0;
            }

            p {
                  margin: 0.75rem 0;
                  color: #475569;
            }

            ul {
                  margin: 0.75rem 0;
                  padding-left: 1.5rem;
            }

            li {
                  margin: 0.375rem 0;
                  color: #475569;
            }

            strong {
                  color: #0f172a;
                  font-weight: 600;
            }

            table {
                  width: 100%;
                  border-collapse: collapse;
                  margin: 1.25rem 0;
                  font-size: 0.9375rem;
                  background: #fff;
                  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
                  border-radius: 0.5rem;
                  overflow: hidden;
            }

            th {
                  background-color: #c4b5fd;
                  padding: 0.875rem 1rem;
                  text-align: left;
                  font-weight: 600;
                  color: #4c1d95;
                  border-bottom: 2px solid #a78bfa;
            }

            td {
                  padding: 0.75rem 1rem;
                  color: #334155;
                  border-bottom: 1px solid #e2e8f0;
            }

            tbody tr:hover {
                  background-color: #f5f3ff;
            }

            code {
                  font-family: 'Fira Code', monospace;
                  font-size: 0.875rem;
                  background-color: #f5f3ff;
                  color: #7c3aed;
                  padding: 0.125rem 0.375rem;
                  border-radius: 0.25rem;
            }

            pre {
                  background-color: #1e293b;
                  color: #e2e8f0;
                  padding: 1.25rem;
                  border-radius: 0.5rem;
                  overflow-x: auto;
                  margin: 1.25rem 0;
            }

            pre code {
                  background: none;
                  color: inherit;
                  padding: 0;
            }

            .flow-step {
                  background-color: #f5f3ff;
                  border-left: 3px solid #8b5cf6;
                  padding: 0.875rem 1rem;
                  margin: 0.5rem 0;
                  border-radius: 0.25rem;
                  color: #334155;
            }

            hr {
                  border: none;
                  border-top: 1px solid #e2e8f0;
                  margin: 2rem 0;
            }
      </style>
</head>

<body>
      <h1>üìä CURSOR ‚Äì B√°o C√°o Doanh Thu D·ªãch V·ª•</h1>

      <h2>CS_REPORT_REVENUE_SERVICE ‚Äì T·ªïng h·ª£p doanh thu theo d·ªãch v·ª•</h2>

      <div class="section">
            <h3>üìå M·ª•c ƒë√≠ch</h3>
            <p>Cursor ƒë·ªÉ <strong>t√≠nh to√°n v√† t·∫°o b√°o c√°o</strong> doanh thu t·ª´ng d·ªãch v·ª•:</p>
            <ul>
                  <li>Duy·ªát qua t·ª´ng d·ªãch v·ª• trong h·ªá th·ªëng</li>
                  <li>T√≠nh t·ªïng doanh thu t·ª´ CT_SUDUNG_DV</li>
                  <li>T√≠nh s·ªë l∆∞·ª£ng ƒë√£ b√°n</li>
                  <li>L∆∞u v√†o b·∫£ng b√°o c√°o</li>
            </ul>
      </div>

      <hr>

      <div class="section">
            <h3>üéØ Khi n√†o ch·∫°y</h3>
            <table>
                  <thead>
                        <tr>
                              <th>Lo·∫°i</th>
                              <th>T·∫ßn su·∫•t</th>
                              <th>Output</th>
                        </tr>
                  </thead>
                  <tbody>
                        <tr>
                              <td>Monthly Report</td>
                              <td>Cu·ªëi th√°ng</td>
                              <td>BC_DOANH_THU_DV</td>
                        </tr>
                        <tr>
                              <td>On-demand</td>
                              <td>Khi c·∫ßn</td>
                              <td>Result set</td>
                        </tr>
                  </tbody>
            </table>
      </div>

      <hr>

      <div class="section">
            <h3>üîÑ Logic x·ª≠ l√Ω</h3>
            <div class="flow-step">1. Nh·∫≠n tham s·ªë <code>@FromDate</code> v√† <code>@ToDate</code></div>
            <div class="flow-step">2. DECLARE CURSOR cho SELECT * FROM DICHVU</div>
            <div class="flow-step">3. WHILE @@FETCH_STATUS = 0:</div>
            <div class="flow-step" style="margin-left: 2rem;">a. SUM(so_luong √ó don_gia) t·ª´ CT_SUDUNG_DV trong kho·∫£ng
                  th·ªùi gian</div>
            <div class="flow-step" style="margin-left: 2rem;">b. COUNT(*) t·ªïng s·ªë l·∫ßn s·ª≠ d·ª•ng</div>
            <div class="flow-step" style="margin-left: 2rem;">c. INSERT v√†o <code>BC_DOANH_THU_DV</code></div>
            <div class="flow-step">4. CLOSE v√† DEALLOCATE cursor</div>
      </div>

      <hr>

      <div class="section">
            <h3>üìä Output Report</h3>
            <table>
                  <thead>
                        <tr>
                              <th>C·ªôt</th>
                              <th>Ki·ªÉu</th>
                              <th>M√¥ t·∫£</th>
                        </tr>
                  </thead>
                  <tbody>
                        <tr>
                              <td>dich_vu_id</td>
                              <td>INT</td>
                              <td>ID d·ªãch v·ª•</td>
                        </tr>
                        <tr>
                              <td>ten_dich_vu</td>
                              <td>NVARCHAR</td>
                              <td>T√™n d·ªãch v·ª•</td>
                        </tr>
                        <tr>
                              <td>so_luong_ban</td>
                              <td>INT</td>
                              <td>T·ªïng s·ªë l∆∞·ª£ng</td>
                        </tr>
                        <tr>
                              <td>doanh_thu</td>
                              <td>DECIMAL</td>
                              <td>T·ªïng doanh thu</td>
                        </tr>
                        <tr>
                              <td>thang_bao_cao</td>
                              <td>DATE</td>
                              <td>Th√°ng b√°o c√°o</td>
                        </tr>
                  </tbody>
            </table>
      </div>

      <hr>

      <div class="section">
            <h3>‚úÖ K·∫øt qu·∫£ demo</h3>
            <pre><code>-- Ch·∫°y b√°o c√°o th√°ng 1/2024
EXEC CS_REPORT_REVENUE_SERVICE 
    @FromDate = '2024-01-01',
    @ToDate = '2024-01-31';

-- K·∫øt qu·∫£ trong BC_DOANH_THU_DV
SELECT * FROM BC_DOANH_THU_DV WHERE thang_bao_cao = '2024-01-01';

-- dich_vu_id | ten_dich_vu    | so_luong_ban | doanh_thu
-- 1          | Gi·∫∑t ·ªßi       | 45           | 2,250,000
-- 2          | ƒÇn s√°ng       | 120          | 6,000,000
-- 3          | Spa           | 8            | 4,000,000
-- 4          | Thu√™ xe       | 12           | 3,600,000</code></pre>
      </div>
</body>

</html>