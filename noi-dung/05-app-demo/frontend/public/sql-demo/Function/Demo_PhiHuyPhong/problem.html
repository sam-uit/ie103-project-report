<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Inter', -apple-system, sans-serif; line-height: 1.7; color: #1e293b; background: #fff; margin: 0; padding: 0; }
        h1 { font-size: 1.875rem; font-weight: 700; color: #059669; margin: 0 0 1.5rem 0; padding-bottom: 0.75rem; border-bottom: 2px solid #10b981; }
        h2 { font-size: 1.5rem; font-weight: 600; color: #0f172a; margin: 2rem 0 1rem 0; }
        h3 { font-size: 1.125rem; font-weight: 600; color: #334155; margin: 1.5rem 0 0.75rem 0; }
        p { margin: 0.75rem 0; color: #475569; }
        ul { margin: 0.75rem 0; padding-left: 1.5rem; }
        li { margin: 0.375rem 0; color: #475569; }
        table { width: 100%; border-collapse: collapse; margin: 1.25rem 0; font-size: 0.9375rem; background: #fff; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); border-radius: 0.5rem; overflow: hidden; }
        th { background-color: #6ee7b7; padding: 0.875rem 1rem; text-align: left; font-weight: 600; color: #064e3b; border-bottom: 2px solid #34d399; }
        td { padding: 0.75rem 1rem; color: #334155; border-bottom: 1px solid #e2e8f0; }
        tbody tr:hover { background-color: #ecfdf5; }
        code { font-family: 'Fira Code', monospace; font-size: 0.875rem; background-color: #ecfdf5; color: #059669; padding: 0.125rem 0.375rem; border-radius: 0.25rem; }
        pre { background-color: #1e293b; color: #e2e8f0; padding: 1.25rem; border-radius: 0.5rem; overflow-x: auto; margin: 1.25rem 0; }
        pre code { background: none; color: inherit; padding: 0; }
        .flow-step { background-color: #ecfdf5; border-left: 3px solid #10b981; padding: 0.875rem 1rem; margin: 0.5rem 0; border-radius: 0.25rem; color: #334155; }
        hr { border: none; border-top: 1px solid #e2e8f0; margin: 2rem 0; }
    </style>
</head>
<body>
    <h1>üè® FUNCTION ‚Äì T√≠nh Ph√≠ H·ªßy Ph√≤ng</h1>

    <h2>FN_TINHPHIHUYPHONG ‚Äì T√≠nh to√°n ph√≠ ph·∫°t t·ª± ƒë·ªông</h2>

    <div class="section">
        <h3>üìå M·ª•c ƒë√≠ch</h3>
        <p>Function d√πng ƒë·ªÉ <strong>t√≠nh s·ªë ti·ªÅn ph·∫°t</strong> khi kh√°ch h√†ng y√™u c·∫ßu h·ªßy ph√≤ng, d·ª±a tr√™n th·ªùi gian b√°o tr∆∞·ªõc:</p>
        <ul>
            <li>ƒê·∫£m b·∫£o t√≠nh c√¥ng b·∫±ng v√† t·ª± ƒë·ªông h√≥a quy tr√¨nh ho√†n ti·ªÅn.</li>
            <li>Logic ƒë·ªông d·ª±a tr√™n ng√†y Check-in th·ª±c t·∫ø c·ªßa ph√≤ng.</li>
            <li>Tr·∫£ v·ªÅ s·ªë ti·ªÅn ch√≠nh x√°c ƒë·ªÉ tr·ª´ v√†o t√†i kho·∫£n kh√°ch.</li>
        </ul>
    </div>

    <hr>

    <div class="section">
        <h3>üì• Tham s·ªë</h3>
        <table>
            <thead>
                <tr>
                    <th>T√™n</th>
                    <th>Ki·ªÉu</th>
                    <th>M√¥ t·∫£</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>@MaDatPhong</code></td>
                    <td>INT</td>
                    <td>M√£ ƒë∆°n ƒë·∫∑t ph√≤ng c·∫ßn h·ªßy</td>
                </tr>
                <tr>
                    <td><code>@NgayBaoHuy</code></td>
                    <td>DATETIME</td>
                    <td>Th·ªùi ƒëi·ªÉm kh√°ch g·ª≠i y√™u c·∫ßu h·ªßy</td>
                </tr>
            </tbody>
        </table>
    </div>

    <hr>

    <div class="section">
        <h3>üì§ Gi√° tr·ªã tr·∫£ v·ªÅ</h3>
        <table>
            <thead>
                <tr>
                    <th>Ki·ªÉu</th>
                    <th>√ù nghƒ©a</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>DECIMAL(18, 0)</td>
                    <td>S·ªë ti·ªÅn ph√≠ ph·∫°t (VNƒê) m√† kh√°ch ph·∫£i ch·ªãu.</td>
                </tr>
            </tbody>
        </table>
    </div>

    <hr>

    <div class="section">
        <h3>üîÑ Logic x·ª≠ l√Ω</h3>
        <div class="flow-step">1. L·∫•y th√¥ng tin <code>NgayCheckIn</code> v√† t√≠nh <code>TongTienCoc</code> t·ª´ b·∫£ng CT_DATPHONG.</div>
        <div class="flow-step">2. T√≠nh kho·∫£ng c√°ch: <code>SoNgay = NgayCheckIn - NgayBaoHuy</code>.</div>
        <div class="flow-step">3. N·∫øu SoNgay > 3: <strong>Mi·ªÖn ph√≠ (0ƒë)</strong>.</div>
        <div class="flow-step">4. N·∫øu SoNgay t·ª´ 1 ƒë·∫øn 3: <strong>Ph·∫°t 50%</strong> t·ªïng ti·ªÅn.</div>
        <div class="flow-step">5. N·∫øu SoNgay < 1 (G·∫•p): <strong>Ph·∫°t 100%</strong> t·ªïng ti·ªÅn.</div>
    </div>

    <hr>

    <div class="section">
        <h3>‚úÖ C√°ch s·ª≠ d·ª•ng</h3>
        <pre><code>-- Test c√°c tr∆∞·ªùng h·ª£p b√°o h·ªßy c·ªßa BookingID 3
SELECT 
    dbo.fn_TinhPhiHuyPhong(3, '2023-04-01') AS PhiHuy_XaNgay, -- K·ª≥ v·ªçng: 0
    dbo.fn_TinhPhiHuyPhong(3, '2023-04-04') AS PhiHuy_Gap;    -- K·ª≥ v·ªçng: 600.000</code></pre>
    </div>
</body>
</html>