<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Inter', -apple-system, sans-serif; line-height: 1.7; color: #1e293b; background: #fff; margin: 0; padding: 0; }
        h1 { font-size: 1.875rem; font-weight: 700; color: #059669; margin: 0 0 1.5rem 0; padding-bottom: 0.75rem; border-bottom: 2px solid #10b981; }
        h2 { font-size: 1.5rem; font-weight: 600; color: #0f172a; margin: 2rem 0 1rem 0; }
        h3 { font-size: 1.125rem; font-weight: 600; color: #334155; margin: 1.5rem 0 0.75rem 0; }
        p { margin: 0.75rem 0; color: #475569; }
        ul { margin: 0.75rem 0; padding-left: 1.5rem; }
        li { margin: 0.375rem 0; color: #475569; }
        table { width: 100%; border-collapse: collapse; margin: 1.25rem 0; font-size: 0.9375rem; background: #fff; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); border-radius: 0.5rem; overflow: hidden; }
        th { background-color: #6ee7b7; padding: 0.875rem 1rem; text-align: left; font-weight: 600; color: #064e3b; border-bottom: 2px solid #34d399; }
        td { padding: 0.75rem 1rem; color: #334155; border-bottom: 1px solid #e2e8f0; }
        tbody tr:hover { background-color: #ecfdf5; }
        code { font-family: 'Fira Code', monospace; font-size: 0.875rem; background-color: #ecfdf5; color: #059669; padding: 0.125rem 0.375rem; border-radius: 0.25rem; }
        pre { background-color: #1e293b; color: #e2e8f0; padding: 1.25rem; border-radius: 0.5rem; overflow-x: auto; margin: 1.25rem 0; }
        pre code { background: none; color: inherit; padding: 0; }
        .flow-step { background-color: #ecfdf5; border-left: 3px solid #10b981; padding: 0.875rem 1rem; margin: 0.5rem 0; border-radius: 0.25rem; color: #334155; }
        hr { border: none; border-top: 1px solid #e2e8f0; margin: 2rem 0; }
    </style>
</head>
<body>
    <h1>üè® FUNCTION ‚Äì X·∫øp H·∫°ng Th√†nh Vi√™n</h1>

    <h2>FN_TINHHANGTHANHVIEN ‚Äì Ph√¢n h·∫°ng Loyalty</h2>

    <div class="section">
        <h3>üìå M·ª•c ƒë√≠ch</h3>
        <p>Function Scalar d√πng ƒë·ªÉ <strong>t√≠nh h·∫°ng th√†nh vi√™n</strong> (Loyalty Tier) cho kh√°ch h√†ng:</p>
        <ul>
            <li>D·ª±a tr√™n t·ªïng doanh thu th·ª±c t·∫ø (Realized Revenue).</li>
            <li>Ch·ªâ t√≠nh c√°c giao d·ªãch c√≥ tr·∫°ng th√°i <strong>PAID</strong> ho·∫∑c <strong>SUCCESS</strong>.</li>
            <li>Gi√∫p b·ªô ph·∫≠n CSKH √°p d·ª•ng ch√≠nh s√°ch khuy·∫øn m√£i t·ª± ƒë·ªông.</li>
        </ul>
    </div>

    <hr>

    <div class="section">
        <h3>üì• Tham s·ªë</h3>
        <table>
            <thead>
                <tr>
                    <th>T√™n</th>
                    <th>Ki·ªÉu</th>
                    <th>M√¥ t·∫£</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>@UserID</code></td>
                    <td>INT</td>
                    <td>M√£ kh√°ch h√†ng c·∫ßn ki·ªÉm tra</td>
                </tr>
            </tbody>
        </table>
    </div>

    <hr>

    <div class="section">
        <h3>üì§ Gi√° tr·ªã tr·∫£ v·ªÅ</h3>
        <table>
            <thead>
                <tr>
                    <th>Ki·ªÉu</th>
                    <th>Gi√° tr·ªã c√≥ th·ªÉ</th>
                    <th>ƒêi·ªÅu ki·ªán</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td rowspan="3">VARCHAR(20)</td>
                    <td><code>STANDARD</code></td>
                    <td>T·ªïng chi ti√™u &lt; 5 Tri·ªáu</td>
                </tr>
                <tr>
                    <td><code>GOLD</code></td>
                    <td>5 Tri·ªáu &le; T·ªïng chi ti√™u &lt; 20 Tri·ªáu</td>
                </tr>
                <tr>
                    <td><code>PLATINUM</code></td>
                    <td>T·ªïng chi ti√™u &ge; 20 Tri·ªáu</td>
                </tr>
            </tbody>
        </table>
    </div>

    <hr>

    <div class="section">
        <h3>üîÑ Logic x·ª≠ l√Ω</h3>
        <div class="flow-step">1. Query b·∫£ng <code>PAYMENTS</code> theo UserID.</div>
        <div class="flow-step">2. Filter c√°c giao d·ªãch th√†nh c√¥ng (Status IN 'PAID', 'SUCCESS').</div>
        <div class="flow-step">3. T√≠nh t·ªïng ti·ªÅn: <code>SUM(amount)</code>.</div>
        <div class="flow-step">4. So s√°nh t·ªïng ti·ªÅn v·ªõi c√°c m·ªëc quy ƒë·ªãnh (5tr, 20tr).</div>
        <div class="flow-step">5. Tr·∫£ v·ªÅ t√™n h·∫°ng t∆∞∆°ng ·ª©ng.</div>
    </div>

    <hr>

    <div class="section">
        <h3>‚úÖ C√°ch s·ª≠ d·ª•ng</h3>
        <pre><code>-- Ki·ªÉm tra h·∫°ng c·ªßa kh√°ch h√†ng ID = 1 v√† 3
SELECT 
    dbo.fn_TinhHangThanhVien(1) AS Hang_User1,
    dbo.fn_TinhHangThanhVien(3) AS Hang_User3;</code></pre>
    </div>
</body>
</html>